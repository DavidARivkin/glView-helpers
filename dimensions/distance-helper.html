<link rel="import" href="dimension-helper-base.html">

<script src="DistanceHelper.js"></script>

<polymer-element name="distance-helper" attributes="selectedObject" extends="dimension-helper-base">
  <script>
    Polymer('distance-helper', {
      active:null,
      pointerPosition:null,
      helper:null,
      selectedObject:null,
      
      distance:null,
      ready:function(){
        this.helper = new DistanceHelper({arrowColor:0x000000,textBgColor:"#ffd200"});
      },
      onPicked:function(e){
        console.log("picked", this.localName);
        pickingDatas = e.detail.pickingInfos;
        if(pickingDatas.length == 0) return;
        
        var point = pickingDatas[0].point;//closest point
        var object = pickingDatas[0].object;
      
        if(! this.helper.start){
          this.helper.unset();
          this.helper.setStart(point, object);
          return;
        }else
        {
          this.helper.setEnd( point, object );
          this.distance = this.helper.distance;
          /*this.measurements.push( {type:"distance",start:this.measureDistanceStart.toArray(), 
          end:point.toArray() } );*/
          //this.measureDistanceStart = undefined;
          this.measureDone({type:"distance", value:this.helper.distance,
            start:this.helper.start, end:this.helper.end, 
            startObject: this.helper.startObject, endObject: this.helper.endObject});
          
          this.helper.start = undefined;
        }
      }
     });
  </script>
</polymer-element>
